import{o as It,i as Tt,a as k}from"./lifecycle.Bl0-0ysm.js";import{Q as jt,R as p,W as s,Y as o,d as e,p as j,Z as r,U as n,V as $t,X as g,S as w,_ as v,a0 as rt,a1 as W,T as at,$ as Ct,a2 as Mt,a3 as Bt,a8 as St}from"./render.3hSXMDmx.js";import{e as st,i as ot}from"./each.Cb7YaT0c.js";import{s as Vt}from"./attributes.D0QCp8P6.js";import{s as nt}from"./class.0LOf1YHh.js";import{A as At}from"./api.BgmQpvyL.js";/* empty css                                                  */var Dt=p('<p class="text-purple-100 text-sm mt-1"> </p>'),Et=p('<span class="ml-1 text-xs opacity-75"> </span>'),zt=p('<button><span class="mr-1"> </span> <!></button>'),Yt=p('<div class="p-4 border-b border-gray-200 dark:border-gray-600"><div class="flex flex-wrap gap-2"></div></div>'),Ft=p('<div class="flex items-center justify-center py-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"></div> <span class="ml-2 text-gray-600 dark:text-gray-300">加载中...</span></div>'),Nt=p('<div class="text-center py-8"><p class="text-red-500 mb-4"> </p> <button class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors">重新加载</button></div>'),Ot=p('<div class="group"><a target="_blank" rel="noopener noreferrer" class="block p-4 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-purple-300 dark:hover:border-purple-500 hover:shadow-md transition-all duration-200"><div class="flex items-start gap-3"><div class="flex-shrink-0"><span class="text-2xl"> </span></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-2"><span class="bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 px-2 py-1 rounded text-xs font-medium"> </span> <span> </span></div> <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100 group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors mb-2"> </h3> <p class="text-xs text-gray-600 dark:text-gray-400 leading-relaxed"> </p></div> <div class="flex-shrink-0"><svg class="w-4 h-4 text-gray-400 group-hover:text-purple-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></div></div></a></div>'),Pt=p('<div class="space-y-4 max-h-96 overflow-y-auto svelte-1j5huy7"></div> <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 pt-4 mt-4 border-t border-gray-200 dark:border-gray-600"><span>数据来源：百度百科</span> <span> </span></div>',1),Qt=p('<div class="text-center py-8 text-gray-500 dark:text-gray-400"><div class="text-4xl mb-2">📅</div> <p>该类型暂无历史事件</p></div>'),Rt=p('<div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden"><div class="bg-gradient-to-r from-purple-500 to-indigo-600 text-white p-4"><h2 class="text-xl font-bold flex items-center gap-2"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path></svg> 历史上的今天</h2> <!></div> <!> <div class="p-4"><!></div></div>');function Ut($,C){jt(C,!1);let d=j(null),B=j(!0),y=j(""),X=j("all"),H=j([]);const S={all:{name:"全部",icon:"📅",color:"text-gray-600"},birth:{name:"诞生",icon:"🎂",color:"text-green-600"},death:{name:"逝世",icon:"🕯️",color:"text-red-600"},event:{name:"事件",icon:"📰",color:"text-blue-600"}};async function Z(){try{g(B,!0),g(y,""),g(d,await At.getTodayInHistory()),q("all")}catch(t){console.error("Failed to load history data:",t),g(y,"API服务暂时不可用，正在尝试备用服务器..."),setTimeout(()=>{e(y)&&g(y,"历史数据加载失败，请检查网络连接或稍后重试")},3e3)}finally{g(B,!1)}}function q(t){g(X,t),e(d)&&(t==="all"?g(H,e(d).items):g(H,e(d).items.filter(a=>a.event_type===t)))}function V(t){const a=S[t]||S.event;return{icon:a.icon,color:a.color,name:a.name}}function it(t,a=100){return t.length<=a?t:t.substring(0,a)+"..."}function lt(t){const a=parseInt(t);return a<0?`公元前${Math.abs(a)}年`:`${t}年`}It(()=>{Z()}),Tt();var A=Rt(),D=s(A),vt=o(s(D),2);{var dt=t=>{var a=Dt(),h=s(a);r(a),w(()=>v(h,`${e(d).date??""} · 共 ${e(d).items.length??""} 个事件`)),n(t,a)};k(vt,t=>{e(d)&&t(dt)})}r(D);var G=o(D,2);{var pt=t=>{var a=Yt(),h=s(a);st(h,5,()=>Object.entries(S),ot,(E,z)=>{var c=Ct(()=>Mt(e(z),2));let i=()=>e(c)[0],x=()=>e(c)[1];var u=zt(),m=s(u),f=s(m,!0);r(m);var _=o(m),I=o(_);{var M=b=>{var T=Et(),Y=s(T);r(T),w(l=>v(Y,`(${l??""})`),[()=>e(d).items.filter(l=>l.event_type===i()).length]),n(b,T)};k(I,b=>{i()!=="all"&&b(M)})}r(u),w(()=>{nt(u,1,`px-3 py-1 rounded-full text-sm font-medium transition-colors
              ${e(X)===i()?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`),v(f,x().icon),v(_,` ${x().name??""} `)}),at("click",u,()=>q(i())),n(E,u)}),r(h),r(a),n(t,a)};k(G,t=>{e(d)&&e(d).items.length>0&&t(pt)})}var J=o(G,2),ct=s(J);{var ut=t=>{var a=Ft();n(t,a)},gt=t=>{var a=rt(),h=W(a);{var E=c=>{var i=Nt(),x=s(i),u=s(x,!0);r(x);var m=o(x,2);r(i),w(()=>v(u,e(y))),at("click",m,Z),n(c,i)},z=c=>{var i=rt(),x=W(i);{var u=f=>{var _=Pt(),I=W(_);st(I,5,()=>e(H),ot,(Y,l)=>{var F=Ot(),N=s(F),K=s(N),O=s(K),L=s(O),xt=s(L,!0);r(L),r(O);var tt=o(O,2),P=s(tt),Q=s(P),ft=s(Q,!0);r(Q);var R=o(Q,2),mt=s(R,!0);r(R),r(P);var U=o(P,2),_t=s(U,!0);r(U);var et=o(U,2),yt=s(et,!0);r(et),r(tt),Bt(2),r(K),r(N),r(F),w((ht,bt,kt,wt,Ht)=>{Vt(N,"href",e(l).link),v(xt,ht),v(ft,bt),nt(R,1,`${kt??""} text-xs font-medium`,"svelte-1j5huy7"),v(mt,wt),v(_t,e(l).title),v(yt,Ht)},[()=>V(e(l).event_type).icon,()=>lt(e(l).year),()=>V(e(l).event_type).color,()=>V(e(l).event_type).name,()=>it(e(l).description)]),n(Y,F)}),r(I);var M=o(I,2),b=o(s(M),2),T=s(b);r(b),r(M),w(()=>v(T,`显示 ${e(H).length??""} 个事件`)),n(f,_)},m=f=>{var _=Qt();n(f,_)};k(x,f=>{e(H).length>0?f(u):f(m,!1)},!0)}n(c,i)};k(h,c=>{e(y)?c(E):c(z,!1)},!0)}n(t,a)};k(ct,t=>{e(B)?t(ut):t(gt,!1)})}r(J),r(A),n($,A),$t()}function Wt(){const $=document.getElementById("history-container"),C=document.getElementById("loading-state");$&&C&&(C.style.display="none",St(Ut,{target:$}))}setTimeout(()=>{Wt()},100);
